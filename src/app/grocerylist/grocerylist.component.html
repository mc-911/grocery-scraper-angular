<div class="grocerylist-container">
    <div class="grocerylist" [style]="mobile && selectedGroceryListItem ? 'display: none;' : ''">
        <div class="grocerylist-title">Grocery List</div>
        <div class="grocerylist-items-container">
            <app-grocery-list-item *ngFor="let item of groceryListItems; index as i" [data]="item"
                (removeItemEvent)="removeGroceryListItem($event)" [index]="i"
                (selectItemEvent)="selectGroceryListItem($event)"
                [borderColor]="item == selectedGroceryListItem ? 'green' : 'black'" />
        </div>
        <div class="grocerylist-add-btn" (click)="toggleAddGroceryListModal()">
            <svg stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="#000000">
                <path d="M6 12H12M18 12H12M12 12V6M12 12V18" stroke="#000000" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round"></path>
            </svg>
        </div>
        <div class="grocerylist-price-container">Total: {{getFormattedMinTotal()}}</div>
    </div>
    <div class="search-container" [style]="mobile && selectedGroceryListItem ? 'display: flex;' : ''"
        *ngIf="selectedGroceryListItem != null; else noSelectedGroceryListItem">
        <div class="search-section">
            <div class="search-bar-container">
                <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                    style="fill: rgba(0, 0, 0, 1);">
                    <path
                        d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396 1.414-1.414-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8 3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6-6-2.691-6-6 2.691-6 6-6z">
                    </path>
                </svg>
                <input type="text" class="search-bar" (keyup.enter)="search()" [formControl]="searchQuery" />
            </div>
            <div class="search-options-container">

                <div class="supermarket-btn-container">
                    <div class="paknsave-bg supermarket-btn"
                        [class]="selectedSupermarkets.includes('paknsave') ? '' : 'disabled' "
                        (mouseup)="toggleSupermarket($event, 'paknsave')">
                        <app-packn-save-svg class="price-logo"></app-packn-save-svg>
                    </div>
                    <div class="countdown-bg supermarket-btn"
                        [class]="selectedSupermarkets.includes('countdown') ? '' : 'disabled' "
                        (mouseup)="toggleSupermarket($event, 'countdown')">
                        <app-countdown-svg class="price-logo"></app-countdown-svg>
                    </div>
                    <div class="newworld-bg supermarket-btn"
                        [class]="selectedSupermarkets.includes('newworld') ? '' : 'disabled' "
                        (mouseup)="toggleSupermarket($event, 'newworld')">
                        <app-new-world-svg class="price-logo"></app-new-world-svg>
                    </div>
                </div>
                <div class="sort-by-category-container">
                    <app-dropdown (selectOptionEvent)="selectCategory($event)" [options]="categories"></app-dropdown>
                    <app-dropdown (selectOptionEvent)="selectSort($event)" [options]="sortingOptions"></app-dropdown>
                </div>
            </div>
        </div>
        <ng-container [ngSwitch]="selectedGroceryListItem.searchState">
            <div *ngSwitchCase="0" class="enter-query-message">Enter your search query for
                "{{selectedGroceryListItem.name}}"
            </div>
            <div *ngSwitchCase="1" class="spinner-container">
                <svg class="spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                    style="fill: rgba(0, 0, 0, 1);">
                    <path
                        d="M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z">
                    </path>
                </svg>
            </div>
            <div *ngSwitchCase="2" class="results-container">
                <div *ngIf="selectedSupermarkets.includes('paknsave') && selectedGroceryListItem.results"
                    class="supermarket-container">
                    <div class="supermarket-name">PAK'nSAVE</div>
                    <div class="supermarket-results-container">
                        <app-supermarket-item-card #showPakNSaveResults
                            *ngFor="let item of selectedGroceryListItem.results['paknsave']"
                            [selectedGroceryListItem]="selectedGroceryListItem" [supermarket]="0" [data]="item" />
                        <div *ngIf="selectedGroceryListItem.results['paknsave'].length == 0;" class="noResultsMessage">
                            No Results</div>
                    </div>
                </div>
                <div *ngIf="selectedSupermarkets.includes('countdown') && selectedGroceryListItem.results"
                    class="supermarket-container">
                    <div class="supermarket-name">Countdown</div>
                    <div class="supermarket-results-container">
                        <app-supermarket-item-card *ngFor="let item of selectedGroceryListItem.results['countdown']"
                            [selectedGroceryListItem]="selectedGroceryListItem" [supermarket]="1" [data]="item" />
                        <div *ngIf="selectedGroceryListItem.results['countdown'].length == 0;" class="noResultsMessage">
                            No Results</div>
                    </div>
                </div>
                <div *ngIf="selectedSupermarkets.includes('newworld') && selectedGroceryListItem.results"
                    class="supermarket-container">
                    <div class="supermarket-name">New World</div>
                    <div class="supermarket-results-container">
                        <app-supermarket-item-card *ngFor="let item of selectedGroceryListItem.results['newworld']"
                            [selectedGroceryListItem]="selectedGroceryListItem" [supermarket]="2" [data]="item" />
                        <div *ngIf="selectedGroceryListItem.results['newworld'].length == 0;" class="noResultsMessage">
                            No Results</div>
                    </div>
                </div>
            </div>
        </ng-container>
        <div class="mobile-total-price-container">
            <div (click)="unselectGroceryListItem()" class="return-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);">
                    <path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path>
                </svg>
            </div>
            <div class="mobile-total-price">
                Total: {{getFormattedMinTotal()}}
            </div>
        </div>
    </div>
    <ng-template #noSelectedGroceryListItem>
        <div class="noSelectedGroceryListItem">
            Add or Select a Grocery Item to start searching
        </div>
    </ng-template>
    <dialog id="addGroceryListItemModal">
        <div class="addGroceryListItemFlexContainer">
            <div class="addGroceryListItemTitle">
                New Grocery List Item
            </div>
            <div class="addGroceryListItemInputSection">
                <div class="input-container">
                    <label>Name</label>
                    <input [formControl]="newGroceryListItemName" id="groceryListItemName" type="text" />
                </div>
                <div class="input-container">
                    <label>Search Query</label>
                    <input [formControl]="newGroceryListSearchQuery" id="groceryListItemSearchQuery" type="text" />
                </div>
            </div>
            <div class="addGroceryListItemFooterSection">
                <div (click)="toggleAddGroceryListModal()">
                    Close
                </div>
                <div (click)="addGroceryListItem()">
                    Add
                </div>
            </div>
        </div>
    </dialog>
    <app-notification-container [messages]="notifications"></app-notification-container>

</div>